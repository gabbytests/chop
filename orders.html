<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Askbootstrap">
    <meta name="author" content="Askbootstrap">
    <link rel="icon" type="image/png" href="img/fav.png">
    <title>Chawmp</title>
    <!-- Slick Slider -->
    <link href="vendor/slick/slick/slick.css" rel="stylesheet" type="text/css">
    <link href="vendor/slick/slick/slick-theme.css" rel="stylesheet" type="text/css">
    <!-- Feather Icon-->
    <link href="vendor/icons/feather.css" rel="stylesheet" type="text/css">
    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom styles for this template -->
    <link href="css/style.css" rel="stylesheet">
    <!-- Sidebar CSS -->
    <link href="vendor/sidebar/demo.css" rel="stylesheet">

    <style>
    .text-danger {
        color: #00c8ff !important; /* üî¥ Bootstrap Danger Red */
        transition: color 0.3s ease, transform 0.2s ease;
    }
    
    /* üî• Hover Effect for a Smooth Interaction */
    .text-danger:hover {
        color: #00c8ff !important; /* üî¥ Darker Red on Hover */
        transform: scale(1.05); /* üî• Slight zoom effect */
    }
    </style>
</head>


<body class="fixed-bottom-bar">
    <div class="osahan-checkout">
        <div class="bg-primary border-bottom p-3 d-flex align-items-center">
            <h4 class="fw-bold m-0 text-white"><i class="feather-list me-2"></i>My Orders</h4>
        </div>

        <div class="container py-5">
            <div id="orders-list"></div>
        </div>
    </div>

   
        <!-- Footer -->
        <div class="osahan-menu-fotter fixed-bottom bg-dark px-3 py-2 text-center  ">
            <div class="row">
                <div class="col">
                    <a href="index.html" class="text-white small fw-bold text-decoration-none">
                        <p class="h4 m-0"><i class="feather-map-pin"></i></p>
                        Trending
                    </a>
                </div>
                <div class="col selected">
                    <a href="trending.html" class="text-white small fw-bold text-decoration-none">
                        <p class="h4 m-0"><i class="feather-home text-white"></i></p>
                        Home
                    </a>
                </div>
                <div class="col">
                        <a href="cart.html" class="text-white small fw-bold text-decoration-none">
                           <p class="h4 m-0"> <i class="feather-shopping-cart"></i></p>
                           Cart
                        </a>
                   
                </div>
                <div class="col">
                    <a href="orders.html" class="text-danger small fw-bold text-decoration-none">
                        <p class="h4 m-0"><i class="feather-shopping-bag"></i></p>
                        Orders
                    </a>
                </div>
                <div class="col">
                    <a href="profile.html" class="text-white small fw-bold text-decoration-none">
                        <p class="h4 m-0"><i class="feather-user"></i></p>
                        Profile
                    </a>
                </div>
            </div>
        </div>
    </div>
    <!-- footer -->
     


   
    <!-- Bootstrap core JavaScript -->
    <script type="0ca9ecdeaaf0ffdafb98bd0b-text/javascript" src="vendor/jquery/jquery.min.js"></script>
    <script type="0ca9ecdeaaf0ffdafb98bd0b-text/javascript" src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <!-- slick Slider JS-->
    <script type="0ca9ecdeaaf0ffdafb98bd0b-text/javascript" src="vendor/slick/slick/slick.min.js"></script>
    <!-- Sidebar JS-->
    <script type="0ca9ecdeaaf0ffdafb98bd0b-text/javascript" src="vendor/sidebar/hc-offcanvas-nav.js"></script>
    <!-- Custom scripts for all pages-->
    <script type="0ca9ecdeaaf0ffdafb98bd0b-text/javascript" src="js/osahan.js"></script>
<script src="cdn-cgi/scripts/7d0fa10a/cloudflare-static/rocket-loader.min.js" data-cf-settings="0ca9ecdeaaf0ffdafb98bd0b-|49" defer></script>




<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.9.0/firebase-app.js";
    import { getFirestore, collection, getDocs, orderBy, query, enableIndexedDbPersistence } from "https://www.gstatic.com/firebasejs/10.9.0/firebase-firestore.js";

    const firebaseConfig = {
        apiKey: "AIzaSyADvpUQWo75ExePGoCRirD2mM-lmfM4Cmc",
        authDomain: "von600-7982d.firebaseapp.com",
        projectId: "von600-7982d",
        storageBucket: "von600-7982d.appspot.com",
        messagingSenderId: "164591218045",
        appId: "1:164591218045:web:afe17512e16573e7903014",
        measurementId: "G-E69DMPLXBK"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // ‚úÖ Enable offline caching to fix slow loading
    enableIndexedDbPersistence(db).catch((err) => {
        console.warn("‚ö†Ô∏è Firestore offline persistence failed:", err);
    });

    async function loadOrders() {
    const ordersList = document.getElementById("orders-list");
    ordersList.innerHTML = "<p class='text-center text-white'>Loading orders...</p>";

    try {
        const q = query(collection(db, "orders"), orderBy("timestamp", "desc"));
        const querySnapshot = await getDocs(q);

        if (!querySnapshot || querySnapshot.empty) {
            ordersList.innerHTML = "<p class='text-center text-white'>No orders found.</p>";
            return;
        }

        let output = "";
        querySnapshot.docs.forEach(docSnap => {
            const data = docSnap.data();
            
            // ‚úÖ Fallback to empty array if items are missing
            const orderItems = Array.isArray(data.items) ? data.items : [];
            if (orderItems.length === 0) {
                console.warn(`‚ö†Ô∏è Order ${docSnap.id} has no items, skipping...`);
                return;
            }

            const orderTime = new Date(data.timestamp).toLocaleString();
            let itemsList = orderItems.map(item => `
                <li class="text-white small">${item.quantity}x ${item.name} - $${item.total.toFixed(2)}</li>
            `).join("");

            output += `
                <div class="order-box bg-dark p-3 mb-3 rounded">
                    <h5 class="fw-bold text-white">Order on ${orderTime}</h5>
                    <p class="order-id text-white-50 small">Order ID: <span>${docSnap.id}</span></p>
                    <ul class="list-unstyled">${itemsList}</ul>
                    <hr class="bg-light">
                    <p class="order-total text-white fw-bold">Total: $${data.totalAmount.toFixed(2)}</p>
                </div>
            `;
        });

        ordersList.innerHTML = output;

    } catch (error) {
        console.error("‚ùå Error loading orders:", error);
        ordersList.innerHTML = "<p class='text-center text-danger'>Failed to load orders.</p>";
    }
}


    document.addEventListener("DOMContentLoaded", loadOrders);
</script>



</body>

</html>

